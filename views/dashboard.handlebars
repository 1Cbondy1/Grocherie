<div class="ui top attached tabular menu">
    <a class="item active" data-tab="first">Manage</a>
    <a class="item" data-tab="second">Shop</a>
    {{!-- <a class="item" data-tab="third">Wallet</a> --}}
</div>

<br><br>

<div class="container">

    {{!-- MANAGE TAB --}}

    <div class="ui bottom attached tab segment active" data-tab="first">
        <h1>Manage Lists!</h1>
        <div class="ui styled accordion">

            {{#each lists}}

                <div class="title">
                    <i class="dropdown icon"></i>
                    {{this.title}}
                    <span class="add-user-button" style="padding-left: 10px"><i class="large user plus icon"></i></span>
                </div>

                <div class="content">
                    <div style="padding-top:20px; padding-left:5px" class="ui middle aligned divided list">

                        <div><input type="text" id="new-item-input" placeholder="Enter a new item..."></input>
                            <span class="new-item-button" data-id="new-item"><i class="teal large plus square icon" style="float:right"></i></span>
                        </div><hr>

                        {{#each this.Task}}
                            <div>
                                <span class="content" style="padding-left: 0px">{{this.text}}</span>
                                <span class="delete-item-button" style="float:right" data-id={{this.id}}><i class="red large minus square icon"></i></span>
                                <p style="font-size:12px">Added by: {{this.originatorId}}</p>
                            </div><hr>
                        {{/each}}

                    </div>
                </div>

            {{/each}}
        
        </div>
    </div>
    
    {{!-- SHOP TAB --}}

    <div class="ui bottom attached tab segment" data-tab="second" style="border:sold 1px black">
        <h1> Pick a list! </h1>
        <div class="ui styled accordion">

          {{#each lists}}
          <div class="title">
              <i class="dropdown icon"></i>
              {{this.title}}
          </div>
          <div class="content">
              <div style="padding-top:20px" class="ui middle aligned divided list">
                  {{#each this.Task}}
                  <div class="item">
                  <div class="right floated content">
                      <div class="ui checkbox" data-completed={{this.completed}} data-id={{this.id}}>
                      <input type="checkbox" name="example">
                      <label></label>
                      </div>
                  </div>
                  <div class="content">
                      {{text}}
                  </div>
                  </div>
                  {{/each}}
              </div>
          </div>
          {{/each}}

        </div>
    </div>

</div>

{{!-- <div class="ui bottom attached tab segment" data-tab="third">
    Wallet
</div> --}}

<script type="text/javascript">

// semantic tabs js
$('.menu .item')
    .tab()
;

// semantic accordion js
$('.ui.accordion')
    .accordion()
;

$('.checkbox').on('click', function(event){
  const taskId = $(this).data("id");
  let isComplete = $(this).data("completed");

  // If task is not complete, set to true, else set as false
  if (!isComplete) {
    isComplete = true;
    $(this).attr("data-completed", true)
  } else {
    isComplete = false;
    $(this).attr("data-completed", false)
  }

  let updateTask = {
    id: taskId,
    completed: isComplete
  };

  $.ajax({
    method: "PUT",
    url: "/api/task/checkbox",
    data: updateTask
  }).then(function() {
    console.log("testing put ajax")
  });
});

$(".add-user-button").click(function() {
    alert("Add User");
    console.log($(this).data("class"));
});

$(".new-item-button").click(function(event) {

    var createTask = {
        text: $("#new-item-input").val().trim(),
        price: 0,
        listId: 1,
        originatorId: 1
    };
    console.log(createTask);

    $.post("/api/task/create", createTask, function() {
        console.log(createTask);
        window.location.href = "/dashboard/user";
    });

});

$(".delete-item-button").click(function() {
    event.preventDefault();

    const taskId = $(this).data("id");
    $.ajax({
        method: "DELETE",
        url: "/api/task/delete/" + taskId,
    }).then(function() {
        console.log("testing delete ajax")
    });
});

// var socket = io.connect(window.location);

</script>
